<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Hold'em Showdown Brute-Force Solver</title>
    <style>
        :root { --primary: #ff9900; --bg: #121212; --card: #1e1e1e; --text: #ffffff; --border: #333; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; padding: 20px; }
        .layout { display: flex; max-width: 1100px; width: 100%; gap: 20px; }
        
        /* Main Calculator Area */
        .main-calc { flex: 2; background: var(--card); padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* Sidebar Area */
        .sidebar { flex: 1; display: flex; flex-direction: column; gap: 20px; min-width: 280px; }
        .paytable-card { background: var(--card); padding: 15px; border-radius: 10px; border: 1px solid var(--border); font-size: 0.85rem; }
        .paytable-card h3 { color: var(--primary); margin-top: 0; font-size: 1rem; border-bottom: 1px solid var(--border); padding-bottom: 5px; }
        .pt-row { display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid #222; }
        
        /* Card Inputs */
        .section-label { font-weight: bold; color: var(--primary); margin-top: 20px; border-bottom: 1px solid #333; padding-bottom: 5px; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 1px; }
        .card-row { display: flex; flex-wrap: wrap; gap: 8px; margin: 15px 0; }
        .card-input { background: #2a2a2a; padding: 8px; border-radius: 8px; text-align: center; border: 1px solid #444; flex: 1; min-width: 90px; }
        select { background: #333; color: white; border: 1px solid #555; padding: 6px; border-radius: 4px; width: 100%; margin-top: 5px; cursor: pointer; font-size: 0.9rem; }
        
        button { width: 100%; padding: 15px; background: var(--primary); color: #000; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; margin-top: 20px; }
        .result-box { margin-top: 25px; padding: 20px; background: #000; border-radius: 10px; display: none; border: 1px solid var(--primary); text-align: center; }
        .ev-val { display: block; font-size: 1.5rem; font-weight: bold; margin-top: 5px; }
        .win { color: #2ecc71; } .loss { color: #e74c3c; }
    </style>
</head>
<body>

<div class="layout">
    <div class="main-calc">
        <h1 style="color:var(--primary); margin:0;">Showdown Solver</h1>
        <p style="color: #888; font-size: 0.9rem;">Brute-Force Calculation (990 Dealer Combinations)</p>

        <div class="section-label">Your Hole Cards</div>
        <div class="card-row">
            <div class="card-input">Card 1<br><select class="rank" id="r1"></select><select class="suit" id="s1"></select></div>
            <div class="card-input">Card 2<br><select class="rank" id="r2"></select><select class="suit" id="s2"></select></div>
        </div>

        <div class="section-label">Community Board</div>
        <div class="card-row">
            <div class="card-input">F1<br><select class="rank" id="fr1"></select><select class="suit" id="fs1"></select></div>
            <div class="card-input">F2<br><select class="rank" id="fr2"></select><select class="suit" id="fs2"></select></div>
            <div class="card-input">F3<br><select class="rank" id="fr3"></select><select class="suit" id="fs3"></select></div>
        </div>
        <div class="card-row">
            <div class="card-input">Turn<br><select class="rank" id="tr"></select><select class="suit" id="ts"></select></div>
            <div class="card-input">River<br><select class="rank" id="rr"></select><select class="suit" id="rs"></select></div>
        </div>

        <button onclick="solve()">CALCULATE BRUTE-FORCE EV</button>

        <div id="result-box" class="result-box">
            <div style="font-size: 1rem;">Optimal Action: <span id="best-act" style="color:var(--primary); font-weight:bold;"></span></div>
            <div style="display:flex; justify-content: space-around; margin-top:15px;">
                <div>Main Game EV<span id="ev-main" class="ev-val"></span></div>
                <div>Triple Up EV<span id="ev-triple" class="ev-val"></span></div>
            </div>
            <div id="hand-name" style="margin-top:10px; font-size:0.8rem; color:#888;"></div>
        </div>
    </div>

    <div class="sidebar">
        <div class="paytable-card">
            <h3>Blind Pay Table</h3>
            <div class="pt-row"><span>Royal Flush</span> <span>500 to 1</span></div>
            <div class="pt-row"><span>Straight Flush</span> <span>50 to 1</span></div>
            <div class="pt-row"><span>Four-of-a-Kind</span> <span>10 to 1</span></div>
            <div class="pt-row"><span>Full House</span> <span>3 to 1</span></div>
            <div class="pt-row"><span>Flush</span> <span>3 to 2</span></div>
            <div class="pt-row"><span>Straight</span> <span>1 to 1</span></div>
        </div>

        <div class="paytable-card">
            <h3>Triple Up Side Bet</h3>
            <div class="pt-row"><span>Royal Flush</span> <span>50 to 1</span></div>
            <div class="pt-row"><span>Straight Flush</span> <span>40 to 1</span></div>
            <div class="pt-row"><span>Four-of-a-Kind</span> <span>30 to 1</span></div>
            <div class="pt-row"><span>Full House</span> <span>8 to 1</span></div>
            <div class="pt-row"><span>Flush</span> <span>7 to 1</span></div>
            <div class="pt-row"><span>Straight</span> <span>4 to 1</span></div>
            <div class="pt-row"><span>Three-of-a-Kind</span> <span>3 to 1</span></div>
        </div>
    </div>
</div>

<script>
const rankMap = {14:'A', 13:'K', 12:'Q', 11:'J', 10:'10', 9:'9', 8:'8', 7:'7', 6:'6', 5:'5', 4:'4', 3:'3', 2:'2'};
const suitMap = {'s':'♠', 'h':'♥', 'd':'♦', 'c':'♣'};
const blindPayouts = {10:500, 9:50, 8:10, 7:3, 6:1.5, 5:1};
const triplePayouts = {10:50, 9:40, 8:30, 7:8, 6:7, 5:4, 4:3};

function init() {
    document.querySelectorAll('.rank').forEach(sel => {
        for (let val in rankMap) {
            let opt = document.createElement('option');
            opt.value = val; opt.innerText = rankMap[val];
            sel.appendChild(opt);
        }
    });
    document.querySelectorAll('.suit').forEach(sel => {
        for (let val in suitMap) {
            let opt = document.createElement('option');
            opt.value = val; opt.innerText = suitMap[val];
            sel.appendChild(opt);
        }
    });
}
init();

function evaluate(cards) {
    const r = cards.map(c => c.r).sort((a,b) => b-a);
    const s = cards.map(c => c.s);
    const suitCounts = s.reduce((a,v) => (a[v]=(a[v]||0)+1, a), {});
    const counts = r.reduce((a,v) => (a[v]=(a[v]||0)+1, a), {});
    const freq = Object.values(counts).sort((a,b) => b-a);
    const isFlush = Object.values(suitCounts).some(v => v >= 5);
    const unique = [...new Set(r)];
    let strHigh = -1;
    for(let i=0; i<=unique.length-5; i++) if(unique[i]-unique[i+4]===4) { strHigh = unique[i]; break; }
    if(strHigh === -1 && [14,5,4,3,2].every(x => unique.includes(x))) strHigh = 5;

    if(isFlush && strHigh === 14) return {score:10, name:"Royal Flush"};
    if(isFlush && strHigh !== -1) return {score:9, name:"Straight Flush"};
    if(freq[0] === 4) return {score:8, name:"Four-of-a-Kind"};
    if(freq[0] === 3 && freq[1] >= 2) return {score:7, name:"Full House"};
    if(isFlush) return {score:6, name:"Flush"};
    if(strHigh !== -1) return {score:5, name:"Straight"};
    if(freq[0] === 3) return {score:4, name:"Three-of-a-Kind"};
    if(freq[0] === 2 && freq[1] === 2) return {score:3, name:"Two Pairs"};
    if(freq[0] === 2) return {score:2, name:"One Pair"};
    return {score:1, name:"High Card"};
}

function solve() {
    const p1 = {r: parseInt(document.getElementById('r1').value), s: document.getElementById('s1').value};
    const p2 = {r: parseInt(document.getElementById('r2').value), s: document.getElementById('s2').value};
    const board = [
        {r: parseInt(document.getElementById('fr1').value), s: document.getElementById('fs1').value},
        {r: parseInt(document.getElementById('fr2').value), s: document.getElementById('fs2').value},
        {r: parseInt(document.getElementById('fr3').value), s: document.getElementById('fs3').value},
        {r: parseInt(document.getElementById('tr').value), s: document.getElementById('ts').value},
        {r: parseInt(document.getElementById('rr').value), s: document.getElementById('rs').value}
    ];

    const deck = [];
    for(let r in rankMap) for(let su in suitMap) deck.push({r:parseInt(r), s:su});
    const known = [p1, p2, ...board];
    const rem = deck.filter(c => !known.some(k => k.r===c.r && k.s===c.s));

    const pRes = evaluate([...playerHole = [p1, p2], ...board]);
    let totalEV = 0, count = 0;

    for(let i=0; i<rem.length; i++) {
        for(let j=i+1; j<rem.length; j++) {
            count++;
            const dRes = evaluate([rem[i], rem[j], ...board]);
            const dQual = dRes.score >= 2;
            let handEV = 0;
            if(pRes.score > dRes.score) {
                handEV += 1 + (dQual ? 1 : 0) + (blindPayouts[pRes.score] || 0);
            } else if(pRes.score < dRes.score) {
                handEV -= 1 + 1 + (dQual ? 1 : 0);
            }
            totalEV += handEV;
        }
    }

    const mainEV = totalEV / count;
    const tripleEV = triplePayouts[pRes.score] || -1;
    
    document.getElementById('result-box').style.display = 'block';
    document.getElementById('best-act').innerText = mainEV > -2.0 ? "BET 1x" : "FOLD";
    document.getElementById('ev-main').innerText = mainEV.toFixed(3);
    document.getElementById('ev-main').className = "ev-val " + (mainEV >= 0 ? "win" : "loss");
    document.getElementById('ev-triple').innerText = tripleEV >= 0 ? "+" + tripleEV : "-1";
    document.getElementById('ev-triple').className = "ev-val " + (tripleEV >= 0 ? "win" : "loss");
    document.getElementById('hand-name').innerText = "Current Hand: " + pRes.name;
}
</script>
</body>
</html>
